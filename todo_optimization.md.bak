# ğŸš€ Optimisations Performance - biobazard3d

Ce document liste les optimisations identifiÃ©es lors de la revue de code du moteur (FÃ©vrier 2026).

## ğŸŸ¢ PrioritÃ© : Haute (Gain immÃ©diat, Faible effort)

### 1. Ã‰limination des allocations par frame (Heap Pressure)
*   **Fichier :** `src/bb3d/render/Renderer.cpp`
*   **ProblÃ¨me :** Les vecteurs `commands` et `instanceTransforms` dans `drawScene` sont rÃ©allouÃ©s Ã  chaque frame.
*   **Action :** 
    *   [x] DÃ©placer les vecteurs en membres privÃ©s de la classe `Renderer`.
    *   [x] Utiliser `reserve()` au dÃ©marrage.
    *   [x] Appeler `clear()` Ã  chaque dÃ©but de frame au lieu de dÃ©truire l'objet.
*   **BÃ©nÃ©fice :** ZÃ©ro allocation dynamique dans le "Hot Path" de rendu. (TerminÃ© : FÃ©vrier 2026)

### 2. Staging Buffer Manager & Uploads Asynchrones
*   **Fichier :** `src/bb3d/render/Buffer.cpp`
*   **ProblÃ¨me :** Chaque crÃ©ation de Mesh/Texture fait un `waitIdle` sur le GPU pour le transfert.
*   **Action :** 
    *   [x] CrÃ©er un `StagingManager` avec un buffer circulaire de ~64MB.
    *   [x] Batcher les transferts de donnÃ©es.
    *   [x] Utiliser des Fences pour libÃ©rer les zones du staging buffer sans bloquer le CPU.
*   **BÃ©nÃ©fice :** Chargement d'assets 10x plus rapide, suppression des micro-stutters lors du streaming. (TerminÃ© : FÃ©vrier 2026)

## ğŸŸ¡ PrioritÃ© : Moyenne (Gain CPU, Effort ModÃ©rÃ©)

### 3. ParallÃƒÂ©lisation du Culling & Tri
*   **Fichier :** `src/bb3d/render/Renderer.cpp`
*   **ProblÃƒÂ¨me :** Le culling Frustum et le tri des commandes sont faits sur un seul thread.
*   **Action :** 
    *   [x] Utiliser `JobSystem::dispatch` pour parallÃƒÂ©liser le test d'intersection AABB/Frustum.
    *   [x] Utiliser `std::sort` parallÃƒÂ¨le si possible ou trier par blocs.
*   **BÃƒÂ©nÃƒÂ©fice :** Meilleure utilisation des processeurs multi-cÃ…â€œurs sur les scÃƒÂ¨nes chargÃƒÂ©es. (TerminÃƒÂ© : FÃƒÂ©vrier 2026)

### 4. Affinage des barriÃƒÂ¨res de synchronisation Vulkan
*   **Fichier :** `src/bb3d/render/Renderer.cpp` / `SwapChain.cpp`
*   **ProblÃƒÂ¨me :** Usage frÃƒÂ©quent de `TOP_OF_PIPE` et `BOTTOM_OF_PIPE`.
*   **Action :** 
    *   [x] Remplacer par des stages prÃƒÂ©cis (ex: `COLOR_ATTACHMENT_OUTPUT` -> `FRAGMENT_SHADER`).
    *   [x] Utiliser `vk::DependencyInfo` (Vulkan 1.3) pour simplifier la syntaxe.
*   **BÃƒÂ©nÃƒÂ©fice :** RÃƒÂ©duction des temps d'attente "bulles" du GPU. (TerminÃƒÂ© : FÃƒÂ©vrier 2026)

## ğŸ”´ PrioritÃ© : Basse / Recherche (Expertise requise)

### 5. GPU-Driven Rendering (Indirect Draw & GPU Culling)
*   **ProblÃƒÂ¨me :** Trop de draw calls cÃƒÂ´tÃƒÂ© CPU et culling CPU limitant pour les scÃƒÂ¨nes massives.
*   **Action :** 
    *   [ ] ImplÃƒÂ©menter un SSBO pour les matrices d'objets.
    *   [ ] Utiliser `vkCmdDrawIndexedIndirect` pour envoyer les commandes de dessin groupÃƒÂ©es.
    *   [ ] ImplÃƒÂ©menter un Compute Shader pour le culling Frustum.
*   **BÃƒÂ©nÃƒÂ©fice :** DÃƒÂ©charge totale du CPU pour la visibilitÃƒÂ© et la soumission des commandes de dessin. (TerminÃƒÂ© : FÃƒÂ©vrier 2026)

---
*Note : Document gÃ©nÃ©rÃ© par l'agent Gemini CLI.*
